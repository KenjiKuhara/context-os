# 108 — Phase11-B 表示文言全面見直し

**目的**  
- Node を「タスク」に統一する  
- UUID / node_id / READY / N件 などの開発者語を画面から排除する  
- 数学的・記号的な表現を避け、自然な日本語にする  

**条件**  
- 機能変更なし  
- DB/API 変更なし  
- 表示文言のみ変更  
- すべての画面を対象とする  

**参照**  
- [105_phase11_a_ui_text_audit.md](105_phase11_a_ui_text_audit.md)（現状一覧）  
- [src/app/dashboard/page.tsx](../src/app/dashboard/page.tsx)、[src/components/ProposalPanel.tsx](../src/components/ProposalPanel.tsx)、[src/components/TreeList.tsx](../src/components/TreeList.tsx)、[src/lib/stateMachine.ts](../src/lib/stateMachine.ts)

---

## 1. 内部語 → 表示語の対照表

| 内部語・開発者語 | 表示語（ユーザー向け） | 備考 |
|------------------|------------------------|------|
| **Node** | **タスク** | 一貫して「タスク」に統一 |
| **ノード** | **タスク** | 同上 |
| **node_id** | **タスクのID** またはラベルでは「対象のタスク」に集約 | 履歴フィルタのラベルは「対象のタスク（任意）」等 |
| **UUID** | 画面には出さない。バリデーションエラーは「タスクのIDの形式が正しくありません」 | 「UUID形式ではありません」を廃止 |
| **READY / IN_PROGRESS / NEEDS_DECISION 等** | **着手可能 / 実施中 / 意思決定待ち** 等（STATUS_LABELS を使用） | 一覧・確認ダイアログ・詳細で raw の status を出さない |
| **ステータス** | **状態** | 表示文言は「状態」に統一 |
| **N件 / n件**（だけの表現） | **○件**（数字はそのまま。「子 3 件」→「子タスク 3 件」など文脈を補う） | 数学記号の N は使わない。「3件」「5件」は可 |
| **from_node_id / to_node_id** | **元のタスク / 先のタスク** または表示では「タスク A → タスク B」のように要約 | 履歴詳細の英語キーは表示用ラベルに置き換え |
| **parent_node_id** | **親タスク** |  |
| **add_children** | **子タスク（新規）** または「追加するタスク」 |  |
| **relation_type**（raw: depends_on, related 等） | そのまま表示する場合は **依存関係 / 関連** 等にマップ可能（任意）。または英語のまま短く表示 | 日本語化する場合の例: depends_on→依存、related→関連 |
| **group_label** | そのまま（ユーザーが付けた名前） |  |
| **diff_id** | 画面には出さない、または「変更ID」 | 履歴詳細は「変更ID」に置き換え可 |
| **source**（Observer） | **取得元** |  |
| **node_count**（Observer） | **タスク数** |  |
| **rule_version**（Observer） | **ルール版** または「バージョン」 |  |
| **（参考値・06_Temperature_Spec準拠）** | **（参考値）** | 仕様書参照は表示しない |
| **ID の先頭8文字…**（slice(0,8) 表示） | **タスクの識別子（末尾省略）** または「タスク A…」のように要約。長い ID は「先頭のみ表示」と注釈しても可 | 数学的記号 … は日本語として許容 |

---

## 2. 該当箇所一覧

### 2.1 ダッシュボード（page.tsx）

| 箇所（概要） | 現状の表示文言 |
|-------------|----------------|
| 一覧・0件時 | 対象のノードがありません |
| 詳細・未選択時 | 左の一覧からノードをクリックしてください |
| 詳細・温度 | 温度：{value}（参考値・06_Temperature_Spec準拠） |
| フラット一覧・行内 | {n.status}（raw: READY, IN_PROGRESS 等） |
| 確認ダイアログ（Advisor 反映） | Node {targetNodeId} のステータスを {from} → {to} に変更します。よろしいですか？ |
| 推定候補ボタン | {c.status}（{c.label}）※ label は既に日本語の可能性あり |
| Observer 見出し | Observer の提案 |
| Observer メタ | source: / node_count: / rule_version: |
| Observer 警告 | Observer が異常を検知しました（n件） |
| Observer 未取得 | Observer レポートがまだありません。Actions で… |

### 2.2 提案パネル（ProposalPanel.tsx）

| 箇所（概要） | 現状の表示文言 |
|-------------|----------------|
| ユーザー意図 placeholder | 例: 大きなタスクを分解して / この Node の選択肢が知りたい |
| 確認ダイアログ（relation） | Node {from_node_id} と {to_node_id} の間に {relation_type} を 1 本追加します。よろしいですか？ |
| 確認ダイアログ（grouping） | 「{group_label}」で {n} 件の Node をグループ化します。よろしいですか？ |
| 確認ダイアログ（decomposition） | 親 Node {id…} に子 Node を {n} 件作成して紐づけます。よろしいですか？ |
| 復元カード・relation | {from_node_id} → {to_node_id}、relation_type |
| 復元カード・grouping | group_label、node_ids.length 件 |
| 復元カード・decomposition | 親: parent_node_id…、子 add_children.length 件 |
| 反映できる変更案・relation | from_node_id → to_node_id、relation_type |
| 反映できる変更案・grouping | group_label、node_ids.length 件 |
| 反映できる変更案・decomposition | 親: parent_node_id…、子 add_children.length 件 |
| 履歴フィルタ | node_id:、placeholder "node_id（任意）" |
| バリデーション | UUID形式ではありません |
| 履歴詳細・キー表示 | from_node_id, to_node_id, relation_type, diff_id, group_label, node_ids, parent_node_id, add_children (title) |
| 履歴サマリ | from_node_id.slice(0,8)… → to_node_id…、親 parent_node_id… に子 n件 |
| 対象 Node ラベル | 対象 Node（未指定なら 1 件目） |
| 対象選択肢 | n.id.slice(0,8)… タイトル or (無題) |
| 対象なし | 対象Nodeが見つかりません |
| Advisor 状態表示 | 現在のステータス: {status}（{STATUS_LABELS[status]}） |
| Advisor 不明時 | 現在の状態が分からないため反映できません |

### 2.3 TreeList（TreeList.tsx）

| 箇所（概要） | 現状の表示文言 |
|-------------|----------------|
| 子件数 | 子{childCount}件 |
| 行内 status | node.status（raw） |

---

## 3. 差し替え案

### 3.1 ダッシュボード（page.tsx）

| 差し替え前 | 差し替え後 |
|------------|------------|
| 対象のノードがありません | 対象のタスクがありません |
| 左の一覧からノードをクリックしてください | 左の一覧からタスクをクリックしてください |
| （参考値・06_Temperature_Spec準拠） | （参考値） |
| フラット一覧の {n.status} | STATUS_LABELS[n.status] を表示（着手可能、実施中 等） |
| Node {targetNodeId} のステータスを {from} → {to} に変更します。よろしいですか？ | このタスクの状態を {fromLabel} → {toLabel} に変更します。よろしいですか？ |
| 推定候補の {c.status}（{c.label}） | {c.label} のみ表示（または 状態: {c.label}） |
| Observer の提案 | 観測結果の提案（またはそのまま「Observer の提案」） |
| source: | 取得元: |
| node_count: | タスク数: |
| rule_version: | ルール版: |
| Observer が異常を検知しました（n件） | 異常を検知しました（n件） |
| Observer レポートがまだありません。… | 観測結果がまだありません。…（以降は技術案内のため短くするかそのまま） |

### 3.2 提案パネル（ProposalPanel.tsx）

| 差し替え前 | 差し替え後 |
|------------|------------|
| 例: …この Node の選択肢が知りたい | 例: …このタスクの選択肢が知りたい |
| Node {from} と {to} の間に {relation_type} を 1 本追加します。よろしいですか？ | タスク「{from}」と「{to}」の間に {relation_type} を 1 本追加します。よろしいですか？（from/to は省略表示なら「2 件のタスクの間に関係を追加」等に要約可） |
| 「{group_label}」で {n} 件の Node をグループ化します。よろしいですか？ | 「{group_label}」で {n} 件のタスクをグループ化します。よろしいですか？ |
| 親 Node {id…} に子 Node を {n} 件作成して紐づけます。よろしいですか？ | 親タスクに、子タスクを {n} 件追加して紐づけます。よろしいですか？ |
| 復元カード・relation 行 | タスク「{from短い表示}」→「{to短い表示}」{relation_type}（ID は省略または「タスクの識別子」） |
| 復元カード・grouping | {group_label}（{n} 件） |
| 復元カード・decomposition | 親タスクに子タスク {n} 件を追加 |
| 反映できる変更案（relation）内の from/to 表示 | 上記同様、タスクの短い表示または「2 件のタスク」 |
| 子 {add_children.length} 件 | 子タスク {add_children.length} 件 |
| 親: {parent_node_id.slice(0,8)}… | 親タスク（識別子: …）または「親: …」のままでも可 |
| node_id: | 対象のタスク: |
| placeholder "node_id（任意）" | タスクのID（任意） |
| UUID形式ではありません | タスクのIDの形式が正しくありません |
| 履歴詳細の from_node_id: / to_node_id: 等 | 元のタスク: / 先のタスク: / 関係の種類: / 変更ID: / グループ名: / タスク一覧: / 親タスク: / 追加する子（タイトル）: |
| 対象 Node（未指定なら 1 件目） | 対象のタスク（未指定なら 1 件目） |
| 対象選択肢の n.id.slice(0,8)… | タスクの識別子… タイトル、または タイトルのみ＋(無題) |
| 対象Nodeが見つかりません | 対象のタスクが見つかりません |
| 現在のステータス: | 現在の状態: |
| 現在の状態が分からないため反映できません | そのまま（既に「状態」に統一済みなら変更なし） |

### 3.3 TreeList（TreeList.tsx）

| 差し替え前 | 差し替え後 |
|------------|------------|
| 子{childCount}件 | 子タスク {childCount} 件 |
| 行内 node.status（raw） | STATUS_LABELS を渡して表示（着手可能、実施中 等） |

### 3.4 共通・補足

- **relation_type** の値（depends_on, related 等）を画面に出す場合: 日本語マップ（depends_on→依存、related→関連 等）を用意するか、そのまま短く表示するかは運用で決定。
- **反映しました（親 xxx… に子 n 件作成）**: 「反映しました（親タスクに子タスク n 件を追加）」に変更。
- 数値の「n 件」「3 件」はそのままでよい。禁止するのは「N件」という変数名のような表記をそのままユーザーに見せること。

---

## 4. 全画面表示文言の最終レビュー

以下は、上記の差し替えをすべて反映した想定で、画面ごとに「最終的にこう表示する」をまとめた一覧である。実装時はこの表と §3 を突き合わせて置換する。

### 4.1 ダッシュボード

| ブロック | 表示箇所 | 最終表示文言 |
|----------|----------|--------------|
| タイトル | ページタイトル | 状態が見えるダッシュボード |
| サブタイトル | 説明 | 「机の上（アクティブ）」だけをトレーに分けて表示します |
| トレー | ラベル | 全て（机の上）、実施中、判断待ち、外部待ち、冷却中、その他 |
| 一覧 | ヘッダー | 一覧：{トレーラベル} |
| 一覧 | フラット/ツリー | フラット、ツリー |
| 一覧 | 0件 | 対象のタスクがありません |
| 一覧（フラット） | 各行・状態 | STATUS_LABELS の値（着手可能、実施中 等） |
| 一覧（フラット） | 途中内容なし | （途中内容なし） |
| 詳細 | 見出し | 詳細 |
| 詳細 | 未選択 | 左の一覧からタスクをクリックしてください |
| 詳細 | タイトル | （タイトルなし） or タスクのタイトル |
| 詳細 | 状態 | 状態：{STATUS_LABELS[status]} |
| 詳細 | 温度 | 温度：{value}（参考値） |
| 詳細 | 途中内容 | 途中内容： |
| 詳細 | 更新 | 更新： |
| 詳細 | 不明 | （不明） |
| 関連する直近履歴 | 見出し | 関連する直近履歴 |
| 関連する直近履歴 | 取得中/0件/理由 | 取得中… / 該当する履歴はありません / 理由: {value} |
| 何が起きた？ | 見出し・説明・placeholder | 何が起きた？ / 状態の推定に使います。メモとしても履歴に残ります。 / 例：「返信待ちになった」… |
| 推定 | ボタン・結果 | 推定する / 推定結果 / この状態にする / 違う… / 候補を閉じる / メモだけ残す |
| 推定 | 候補ボタン | {c.label}（状態名は日本語ラベルのみ） |
| 推定 | キーワードから推定できなかった | キーワードから状態を推定できませんでした。以下から選ぶか、メモだけ残せます。 |
| 推定 | 他の遷移先 | 他の遷移先を選ぶ： |
| 反映 | 反映中・成功メッセージ | 反映中… / {fromLabel}（{from}）→ {toLabel}（{to}）に変更しました、メモを記録しました（状態は変更なし） |
| 確認ダイアログ（状態変更） | 本文 | このタスクの状態を {fromLabel} → {toLabel} に変更します。よろしいですか？ |
| Observer | 見出し | 観測結果の提案（または Observer の提案） |
| Observer | 取得日時/取得元/タスク数/ルール版/最終観測 | 取得日時: / 取得元: / タスク数: / ルール版: / 最終観測: |
| Observer | 少し古い提案 | ⚠ 少し古い提案です |
| Observer | 異常検知 | 異常を検知しました（n件） |
| Observer | レポートなし | 観測結果がまだありません。… |

### 4.2 提案パネル — 共通・構成案

| ブロック | 表示箇所 | 最終表示文言 |
|----------|----------|--------------|
| パネル | 見出し | 提案パネル |
| 未読込 | 案内 | ダッシュボードを読み込んでから利用できます。 |
| タブ | タブ名 | 構成案、判断案 |
| ユーザー意図 | ラベル・placeholder | ユーザー意図（任意） / 例: 大きなタスクを分解して / このタスクの選択肢が知りたい |
| 構成案 | 実行ボタン | 構成案を生成 |
| 復元ブロック | 見出し | 再表示した変更案（関係の追加 / グループ化 / 分解） |
| 復元・relation | 要約行 | タスク「…」→ タスク「…」{relation_type}（または 2 件のタスクの間に関係を追加） |
| 復元・grouping | 要約 | {group_label}（n 件） |
| 復元・decomposition | 要約 | 親タスクに子タスク n 件を追加 |
| 理由・反映・クリア | ラベル・ボタン | 理由（任意）/ 適用の理由を入力 / この変更を反映する / 反映中… / クリア |
| 反映できる変更案 | 見出し | 反映できる変更案（関係の追加 / グループ化 / 分解） |
| 反映できる変更案 | 各カード・要約 | 上記と同様、タスクは「2 件のタスク」または短い識別表示 |
| 確認ダイアログ | relation | タスク「{from}」と「{to}」の間に {relation_type} を 1 本追加します。よろしいですか？ |
| 確認ダイアログ | grouping | 「{group_label}」で {n} 件のタスクをグループ化します。よろしいですか？ |
| 確認ダイアログ | decomposition | 親タスクに、子タスクを {n} 件追加して紐づけます。よろしいですか？ |
| 成功・エラー | メッセージ | 反映しました（…）/ 反映に失敗しました / 確認の取得に失敗しました / 通信に失敗しました。… / 反映は成功しましたが、画面更新に失敗しました。… |

### 4.3 提案パネル — 履歴

| ブロック | 表示箇所 | 最終表示文言 |
|----------|----------|--------------|
| 履歴 | 見出し | 反映した変更の履歴 |
| フィルタ | 種別・対象のタスク | 種別: / すべて・関連・グループ化・分解 / 対象のタスク: / タスクのID（任意） |
| フィルタ | 絞り込み・バリデーション | 絞り込む / クリア / タスクのIDの形式が正しくありません |
| 履歴 | 読み込み・0件 | 読み込み中… / 履歴の取得に失敗しました / 該当する履歴がありません / まだ反映した変更はありません |
| 履歴詳細 | 再表示ボタン | この変更を候補に再表示する |
| 履歴詳細 | 理由 | 理由: {value} |
| 履歴詳細 | キー表示 | 元のタスク: / 先のタスク: / 関係の種類: / 変更ID: / グループ名: / タスク一覧: / 親タスク: / 追加する子（タイトル）: |
| 履歴サマリ | 要約文 | タスク識別子… → タスク識別子… {relation_type}、または「親タスク… に子 n 件」等、英語 ID を出さない |

### 4.4 提案パネル — 判断案

| ブロック | 表示箇所 | 最終表示文言 |
|----------|----------|--------------|
| 対象 | ラベル・選択肢 | 対象のタスク（未指定なら 1 件目）/ — 未指定 — / タスクの識別子… タイトル or（無題） |
| 判断案 | 実行ボタン | 判断案を生成 |
| 選択中の案 | 見出し・項目 | 選択中の案 / 次の一手: / 必要情報: / 判断基準: / リスク: |
| 状態変更 | 見出し・現在の状態 | 状態を変更する / 現在の状態: {STATUS_LABELS[status]} |
| 状態変更 | 対象なし・不明 | 対象のタスクが見つかりません / 現在の状態が分からないため反映できません |
| 状態変更 | ボタン・監査 | 反映する / 反映中… / 閉じる / 監査用詳細 |
| 選択解除 | ボタン | 選択を解除 |

### 4.5 TreeList

| ブロック | 表示箇所 | 最終表示文言 |
|----------|----------|--------------|
| 開閉 | aria-label | 閉じる / 開く |
| 子件数 | テキスト | 子タスク {childCount} 件 |
| 行内状態 | 表示 | STATUS_LABELS[status]（着手可能、実施中 等） |
| 循環 | 打ち切り | （循環のため表示を打ち切り） |
| 途中内容なし | サブテキスト | （途中内容なし） |

---

## 5. 実装時の注意

- **STATUS_LABELS**: 既に [stateMachine.ts](../src/lib/stateMachine.ts) に定義されている。フラット一覧・TreeList の行・確認ダイアログの from/to には、必ずこのラベルを表示し、raw の status（READY, IN_PROGRESS 等）は出さない。
- **ID の省略表示**: from_node_id 等をそのまま 8 文字切り出して表示している箇所は、「タスクの識別子（先頭のみ）」などの注釈を付けるか、要約文（「2 件のタスクの間に関係を追加」）に置き換える。
- **API/DB のキー名**: リクエスト・レスポンスのキー（node_id, from_node_id 等）は変更しない。変更するのは**画面に表示するラベルとメッセージ**のみ。
- **relation / grouping / decomposition**: 種別の値（API では英語）はそのまま利用し、表示用には「関係の追加」「グループ化」「分解」を使用。括弧内を「relation」から「関係の追加」に変えると、開発者語をさらに減らせる。

以上で、Phase11-B の成果物 4 点（対照表・該当箇所一覧・差し替え案・全画面最終レビュー）を一括で定義した。
